# 第二课
## 注意点
### 传输时延（Transmission Delay）

计算公式为：$传输时延 = \frac{数据包长度}{传输速率}$

### 传播时延（Propagation Delay）

计算公式为：$传播时延 = \frac{传播距离}{传播速率}$
### 注意点1： bps、Kbps、Mbps、Gbps

- bps：比特每秒
- Kbps：千比特每秒
- Mbps：兆比特每秒
- Gbps：千兆比特每秒
- Tbps：太比特每秒

这里1 Kbps = 1000 bps，1 Mbps = 1000 Kbps，1 Gbps = 1000 Mbps，1 Tbps = 1000 Gbps。

### 注意点2： bit、byte、KB、MB、GB、TB

- bit：比特
- byte：字节
- KB：千字节
- MB：兆字节
- GB：千兆字节
- TB：太字节

这里1 byte = 8 bit，1 KB = 1024 byte，1 MB = 1024 KB，1 GB = 1024 MB，1 TB = 1024 GB。
## packet - switching ---> 分组交换

### 什么是分组交换

分组交换是一种数据交换方式，它将数据分成一个个的数据包（packet），然后通过网络进行传输。在分组交换中，每个数据包都包含了目的地址和源地址，这样网络可以根据这些地址来决定如何传输数据包。分组交换的主要特点是：

- **无连接**：分组交换是一种无连接的数据交换方式，每个数据包都是独立地进行传输，不需要建立连接。
- **分组交换**：数据被分成一个个的数据包进行传输，这些数据包可以通过不同的路径进行传输，然后在目的地重新组合。
- **存储转发**：数据包在传输过程中需要经过多个节点，这些节点需要先接收完整的数据包，然后再进行转发。
- **灵活性**：分组交换可以根据网络的负载情况和路径的可用性来动态地选择传输路径，从而提高网络的灵活性和可靠性。
- **高效性**：分组交换可以更好地利用网络的带宽，从而提高网络的传输效率。
- **适用性**：分组交换适用于多种不同的网络环境，包括局域网、广域网和互联网。
- **成本低**：分组交换的成本通常比电路交换和报文交换要低，这使得它成为了一种非常流行的数据交换方式。
- **可靠性**：分组交换可以通过重新发送丢失的数据包来提高网络的可靠性，从而减少数据传输的错误率。
- **安全性**：分组交换可以通过加密和身份验证等技术来提高网络的安全性，从而防止未经授权的访问。

#### store-and-forward ---> 存储转发

存储转发是一种数据交换方式，它将数据包完整地接收到交换机上，然后再进行转发。在存储转发中，数据包需要经过多个节点，这些节点需要先接收完整的数据包，然后再进行转发.

#### transmission delay ---> 传输延迟

传输延迟是指数据包从发送主机传输到交换机所需的时间。由于传输速率为R1，因此传输延迟为L/R1。

#### end-to-end delay ---> 端到端延迟

端到端的延迟主要由两部分组成：发送主机到交换机的传输延迟，以及交换机到接收主机的传输延迟。

在这个情况下，端到端的延迟主要由两部分组成：发送主机到交换机的传输延迟，以及交换机到接收主机的传输延迟。

#### queueing delay ---> 队列延迟

队列延迟是指数据包在交换机的输入队列或输出队列中等待传输的时间。当交换机的输入队列或输出队列中有太多的数据包时，就会出现队列延迟。

#### packet queueing ---> 数据包排队

数据包排队是指数据包在交换机的输入队列或输出队列中等待传输的过程。当交换机的输入队列或输出队列中有太多的数据包时，就会出现数据包排队。

#### packet loss ---> 数据包丢失

数据包丢失是指数据包在传输过程中由于网络拥塞或其他原因而丢失的情况。当数据包丢失时，发送主机需要重新发送数据包，这会增加网络的传输延迟。

如何判断数据包丢的命令
```bash
ping -c 4
```
或者
```bash
ping -t 4
```

### 路由器转发表

路由器转发表是一种用于存储路由器路由信息的数据结构，它包含了路由器的各个接口和对应的目的地址之间的映射关系。路由器转发表的主要作用是帮助路由器决定如何转发数据包，从而实现数据包的路由。

如何查看路由表
```bash
route print
```
在archlinux中
```bash
ip route
```
#### 路由转发表是如何工作的

路由转发表是如何工作的呢？路由转发表的工作原理主要包括以下几个步骤：

1. **接收数据包**：当路由器接收到一个数据包时，它首先会检查数据包的目的地址，然后根据目的地址来查找路由转发表。
2. **查找目的地址**：路由器会在路由转发表中查找与目的地址匹配的条目，然后找到对应的接口。
3. **转发数据包**：路由器会根据路由转发表中的信息来决定如何转发数据包，然后将数据包发送到相应的接口上。
4. **更新路由表**：路由器会定期更新路由转发表，以确保它包含了最新的路由信息。
5. **处理异常情况**：当路由器遇到异常情况时，比如目的地址不可达或者网络拥塞，它会根据路由转发表中的信息来处理这些异常情况。
6. **转发数据包**：路由器会根据路由转发表中的信息来决定如何转发数据包，然后将数据包发送到相应的接口上。
7. **更新路由表**：路由器会定期更新路由转发表，以确保它包含了最新的路由信息。
8. **处理异常情况**：当路由器遇到异常情况时，比如目的地址不可达或者网络拥塞，它会根据路由转发表中的信息来处理这些异常情况。

## 互联网曾经的分组交换技术

### Circuit Switching ---> 电路交换

电路交换是一种数据交换方式，它通过建立一个专用的物理连接来进行数据传输。在电路交换中，数据被分成一个个的数据包进行传输，这些数据包可以通过不同的路径进行传输，然后在目的地重新组合。
#### 电路交换的特点

1. **连接建立**：电路交换需要先建立一个专用的物理连接，然后再进行数据传输。
2. **固定带宽**：电路交换的带宽是固定的，一旦建立了连接，就会占用一定的带宽。
3. **资源占用**：电路交换需要占用一定的资源，包括带宽、路由器和交换机等。
4. **传输效率**：电路交换的传输效率较高，因为数据包可以通过专用的物理连接进行传输。
5. **适用范围**：电路交换适用于需要高带宽和低延迟的场合，比如电话通信和视频会议等。
6. **成本高**：电路交换的成本较高，因为需要占用一定的资源和带宽。

#### FDM ---> 频分复用
`Frequency Division Multiplexing`，频分复用是一种多路复用技术，它通过将数据分成不同的频率进行传输。在频分复用中，每个数据包都被分配一个不同的频率，然后通过这些频率进行传输。

#### TDM ---> 时分复用

`Time Division Multiplexing`，时分复用是一种多路复用技术，它通过将数据分成不同的时间进行传输。在时分复用中，每个数据包都被分配一个不同的时间，然后通过这些时间进行传输。

#### WDM ---> 波分复用

`Wavelength Division Multiplexing`，波分复用是一种多路复用技术，它通过将数据分成不同的波长进行传输。在波分复用中，每个数据包都被分配一个不同的波长，然后通过这些波长进行传输。

#### SDM ---> 空分复用

`Space Division Multiplexing`，空分复用是一种多路复用技术，它通过将数据分成不同的空间进行传输。在空分复用中，每个数据包都被分配一个不同的空间，然后通过这些空间进行传输。

#### 为什么现在不用电路交换

1. **资源浪费**：电路交换需要占用一定的资源，包括带宽、路由器和交换机等，这会导致资源的浪费。
2. **成本高**：电路交换的成本较高，因为需要占用一定的资源和带宽，这使得它不适合于大规模的数据传输。
3. **灵活性差**：电路交换的带宽是固定的，一旦建立了连接，就会占用一定的带宽，这使得它缺乏灵活性。
4. **可靠性差**：电路交换的可靠性较低，因为一旦连接出现故障，就会导致数据传输中断。
5. **安全性差**：电路交换的安全性较低，因为数据包可以通过专用的物理连接进行传输，这使得它容易受到攻击。
6. **管理复杂**：电路交换的管理较为复杂，因为需要占用一定的资源和带宽，这使得它不适合于大规模的数据传输。
7. **扩展性差**：电路交换的扩展性较差，因为需要占用一定的资源和带宽，这使得它不适合于大规模的数据传输。


### Message Switching ---> 报文交换

报文交换是一种数据交换方式，它通过将数据分成一个个的报文（message）进行传输。在报文交换中，每个报文都包含了目的地址和源地址，这样网络可以根据这些地址来决定如何传输报文。
#### 报文交换的特点

1. **无连接**：报文交换是一种无连接的数据交换方式，每个报文都是独立地进行传输，不需要建立连接。
2. **报文交换**：数据被分成一个个的报文进行传输，每个报文都包含了目的地址和源地址，这样网络可以根据这些地址来决定如何传输报文。
3. **存储转发**：报文在传输过程中需要经过多个节点，这些节点需要先接收完整的报文，然后再进行转发。
4. **灵活性**：报文交换可以根据网络的负载情况和路径的可用性来动态地选择传输路径，从而提高网络的灵活性和可靠性。
5. **高效性**：报文交换可以更好地利用网络的带宽，从而提高网络的传输效率。
6. **适用范围**：报文交换适用于多种不同的网络环境，包括局域网、广域网和互联网。
7. **成本低**：报文交换的成本通常比电路交换和报文交换要低，这使得它成为了一种非常流行的数据交换方式。
8. **可靠性**：报文交换可以通过重新发送丢失的报文来提高网络的可靠性，从而减少数据传输的错误率。
9. **安全性**：报文交换可以通过加密和身份验证等技术来提高网络的安全性，从而防止未经授权的访问。
10. **易管理**：报文交换的管理较为简单，因为报文可以通过不同的路径进行传输，然后在目的地重新组合。
11. **易扩展**：报文交换的扩展性较好，因为报文可以通过不同的路径进行传输，然后在目的地重新组合。
##### 为什么现在不用报文交换

现在不用报文交换的原因是因为它的传输效率较低，而且容易受到攻击。报文交换的传输效率较低，因为数据包可以通过不同的路径进行传输，然后在目的地重新组合，这会导致传输延迟较高。而且报文交换的安全性较低，因为数据包可以通过不同的路径进行传输，这使得它容易受到攻击。
### 电路交换和报文交换的区别

电路交换和报文交换的主要区别在于数据传输的方式。在电路交换中，数据被分成一个个的数据包进行传输，这些数据包可以通过不同的路径进行传输，然后在目的地重新组合。而在报文交换中，数据被分成一个个的报文进行传输，每个报文都包含了目的地址和源地址，这样网络可以根据这些地址来决定如何传输报文。


## 题目

### 第一题

```plaintext
Suppose there is exactly one packet switch between a sending host and a receiving host. The transmission rates between the sending host and the switch and between the switch and the receiving host are R1 and R2, respectively. Assuming that the switch uses store-and-forward packet switching, what is the total end-to-end delay to send a packet of length L? (Ignore queuing,propagation delay, and processing delay.)
```
中文翻译
```plaintext
假设在发送主机和接收主机之间有一个数据包交换机。发送主机和交换机之间的传输速率为R1，交换机和接收主机之间的传输速率为R2。假设交换机使用存储转发的数据包交换方式，那么发送长度为L的数据包的总的端到端延迟是多少？（忽略队列、传播延迟和处理延迟。）
```
#### 解答

在这个情况下，端到端的延迟主要由两部分组成：发送主机到交换机的传输延迟，以及交换机到接收主机的传输延迟。

要计算延迟的公式是${端到端延迟} = \frac{数据包长度}{传输速率}$
1. 发送主机到交换机的传输延迟：这是数据包从发送主机传输到交换机所需的时间。由于传输速率为R1，因此传输延迟为L/R1。
2. 交换机到接收主机的传输延迟：这是数据包从交换机传输到接收主机所需的时间。由于传输速率为R2，因此传输延迟为L/R2。
3. 因此，总的端到端延迟为L/R1 + L/R2。

### 第二题

```plaintext
Suppose users share a 2 Mbps link. Also suppose each user transmits continuously at 1 Mbps when transmitting, but each user transmits only 20 percent of the time. When circuit switching is used, how many users can be supported______?
```

中文翻译
```plaintext
假设用户共享一个2 Mbps的链路。还假设每个用户在传输时以1 Mbps的速率连续传输，但每个用户只传输20%的时间。当使用电路交换时，可以支持多少用户______？
```

#### 解答

当使用电路交换时，信道带宽需要用户独占，所以2/1=2最多只能支持2个用户。

公式为$\frac{总带宽}{单用户带宽}$
要注意的是，这里的单用户带宽是指用户独占带宽，而不是用户实际传输的带宽。
### 第四题

```plaintext
Suppose Host A wants to send a large file to Host B. The path from Host A to Host B has three links, of rates R1 = 500 kbps, R2 = 2 Mbps, and R3 = 1 Mbps. Assuming no other traffic in the network, what is the throughput for the file transfer?
```

中文翻译
```plaintext
假设主机A想要向主机B发送一个大文件。从主机A到主机B的路径有三个链路，速率分别为R1 = 500 kbps，R2 = 2 Mbps和R3 = 1 Mbps。假设网络中没有其他流量，文件传输的吞吐量是多少？
```

#### 解答

吞吐量是指在网络中传输数据的速率。在这个问题中，我们需要计算从主机A到主机B的路径的吞吐量。路径的吞吐量是由路径上的最慢链路决定的，因为数据包需要经过最慢的链路才能到达目的地。

在这个问题中，路径上的最慢链路是R1 = 500 kbps，因此路径的吞吐量是500 kbps。

```plaintext
示意图：
Host A -> R1 -> R2 -> R3 -> Host B
```
##### 为什么要选择最慢的链路

因为数据包需要经过最慢的链路才能到达目的地，所以路径的吞吐量是由最慢的链路决定的。
详细的说，吞吐量是指在网络中传输数据的速率。在这个问题中，我们需要计算从主机A到主机B的路径的吞吐量。路径的吞吐量是由路径上的最慢链路决定的，因为数据包需要经过最慢的链路才能到达目的地。

### 课上题

```plaintext
ten-car caravan (aka 10-bit packet)
100 km for next toll booth
Cars "propagate" at  100 km/hr 
Toll booth takes 12 seconds to service a car
car ~ bit
caravan ~ packet

Q:How long does it take to transmit a 10 bit packet to the toll booth?
```

中文翻译
```plaintext
十辆汽车大篷车（也称为10比特数据包）
距离收费站100公里
汽车以100公里/小时的速度“传播”
收费站需要12秒来为一辆汽车服务
汽车~比特
大篷车~数据包

问题：将一个10比特的数据包传输到收费站需要多长时间？
```

#### 解答

总共62分钟

1. 10辆车传输到收费站需要的时间是10辆车*12秒=120秒
2. 10辆车传输到收费站需要的时间是100公里/100公里/小时=1小时
3. 10辆车传输到收费站需要的时间是120秒+1小时=62分钟

### 课上题2

```plaintext
现在车速变为1000 km/hr
```

#### 解答

